From: Markus Koschany <apo@debian.org>
Date: Sun, 2 Sep 2018 18:49:45 +0200
Subject: dSAFER sandbox bybass part1

CVE-2018-16542

Bug-Debian: https://bugs.debian.org/907332
Origin: http://git.ghostscript.com/?p=ghostpdl.git;a=commitdiff;h=b575e1ec
---
 psi/interp.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/psi/interp.c b/psi/interp.c
index 506f8b8..911a9a8 100644
--- psi/interp.c
+++ psi/interp.c
@@ -656,7 +656,12 @@ again:
     /* Push the error object on the operand stack if appropriate. */
     if (!ERROR_IS_INTERRUPT(code)) {
         /* Replace the error object if within an oparray or .errorexec. */
-        *++osp = *perror_object;
+        osp++;
+        if (osp >= ostop) {
+            *pexit_code = gs_error_Fatal;
+            return_error(gs_error_Fatal);
+        }
+        *osp = *perror_object;
         errorexec_find(i_ctx_p, osp);
     }
     goto again;
